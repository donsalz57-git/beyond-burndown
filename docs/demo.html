<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Beyond Burndown - Interactive Demo</title>
  <meta name="description" content="Try Beyond Burndown's full feature set with realistic demo data.">
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
  <style>
    :root {
      --green: #00875A;
      --yellow: #FF8B00;
      --red: #DE350B;
      --blue: #0052CC;
      --purple: #9C27B0;
      --gray: #5E6C84;
      --light-gray: #F4F5F7;
      --border: #DFE1E6;
      --text: #172B4D;
    }

    * { box-sizing: border-box; }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 0;
      background: #f0f0f0;
      color: var(--text);
    }

    .demo-header {
      background: linear-gradient(135deg, var(--green) 0%, #006644 100%);
      color: white;
      padding: 12px 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .demo-header h1 {
      font-size: 1.125rem;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .demo-badge {
      background: rgba(255,255,255,0.2);
      padding: 3px 10px;
      border-radius: 10px;
      font-size: 0.7rem;
      font-weight: 600;
      margin-left: 8px;
    }

    .demo-container {
      max-width: 1200px;
      margin: 20px auto;
      padding: 0 20px;
    }

    .gadget-container {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      overflow: hidden;
    }

    /* Summary Bar */
    .summary-bar {
      display: flex;
      gap: 20px;
      padding: 12px 16px;
      background: var(--light-gray);
      border-bottom: 1px solid var(--border);
      flex-wrap: wrap;
      align-items: center;
    }

    .summary-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 60px;
    }

    .summary-value {
      font-size: 1.25rem;
      font-weight: 700;
    }

    .summary-value.success { color: var(--green); }
    .summary-value.warning { color: var(--yellow); }
    .summary-value.danger { color: var(--red); }

    .summary-label {
      font-size: 0.65rem;
      color: var(--gray);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .confidence-indicator {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .confidence-bar {
      width: 50px;
      height: 5px;
      background: var(--border);
      border-radius: 3px;
      overflow: hidden;
    }

    .confidence-fill {
      height: 100%;
      border-radius: 3px;
    }

    .confidence-fill.high { background: var(--green); }
    .confidence-fill.medium { background: var(--yellow); }
    .confidence-fill.low { background: var(--red); }

    /* Export Menu */
    .export-menu-container {
      position: relative;
      margin-left: auto;
    }

    .export-btn {
      padding: 6px 12px;
      background: white;
      border: 1px solid var(--border);
      border-radius: 4px;
      font-size: 0.75rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .export-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      background: white;
      border: 1px solid var(--border);
      border-radius: 4px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      display: none;
      min-width: 150px;
      z-index: 50;
    }

    .export-dropdown.open { display: block; }

    .export-dropdown button {
      display: block;
      width: 100%;
      padding: 8px 12px;
      border: none;
      background: none;
      text-align: left;
      font-size: 0.8rem;
      cursor: pointer;
    }

    .export-dropdown button:hover {
      background: var(--light-gray);
    }

    /* Forecast Warning */
    .forecast-warning {
      padding: 10px 16px;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.85rem;
      border-bottom: 1px solid var(--border);
    }

    .forecast-warning.warning {
      background: #FFFAE6;
      border-left: 4px solid var(--yellow);
    }

    .forecast-warning.critical {
      background: #FFEBE6;
      border-left: 4px solid var(--red);
    }

    /* Tabs */
    .tab-navigation {
      display: flex;
      gap: 2px;
      padding: 0 16px;
      background: white;
      border-bottom: 2px solid var(--border);
      overflow-x: auto;
    }

    .tab-button {
      padding: 12px 14px;
      background: transparent;
      border: none;
      font-size: 0.8rem;
      font-weight: 500;
      color: var(--gray);
      cursor: pointer;
      border-bottom: 2px solid transparent;
      margin-bottom: -2px;
      white-space: nowrap;
      display: flex;
      align-items: center;
      gap: 5px;
      transition: all 0.2s;
    }

    .tab-button:hover { color: var(--text); }

    .tab-button.active {
      color: var(--green);
      border-bottom-color: var(--green);
    }

    .badge {
      background: var(--gray);
      color: white;
      padding: 1px 5px;
      border-radius: 8px;
      font-size: 0.65rem;
      font-weight: 600;
    }

    .badge.danger { background: var(--red); }
    .badge.warning { background: var(--yellow); }

    .tab-content {
      padding: 16px;
      min-height: 500px;
    }

    .tab-panel { display: none; }
    .tab-panel.active { display: block; }

    /* Feasibility Tab */
    .feasibility-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      flex-wrap: wrap;
      gap: 12px;
    }

    .score-display-inline {
      display: flex;
      align-items: baseline;
      gap: 8px;
    }

    .score-display-inline .score {
      font-size: 1.75rem;
      font-weight: 700;
    }

    .score-display-inline .label {
      font-size: 0.85rem;
      color: var(--gray);
    }

    .controls-row {
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }

    .period-select {
      padding: 6px 10px;
      border: 2px solid var(--border);
      border-radius: 4px;
      font-size: 0.8rem;
      background: white;
      cursor: pointer;
    }

    .target-date-control {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.75rem;
      color: var(--gray);
    }

    .target-date-control input[type="date"] {
      padding: 4px 8px;
      border: 2px solid var(--red);
      border-radius: 4px;
      font-size: 0.75rem;
    }

    .whatif-toggle {
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    .whatif-toggle.active {
      background: var(--blue);
      color: white;
    }

    .whatif-toggle:not(.active) {
      background: var(--light-gray);
      color: var(--text);
    }

    .overload-warning {
      background: #FFEBE6;
      border-left: 4px solid var(--red);
      padding: 8px 12px;
      margin-bottom: 12px;
      border-radius: 0 4px 4px 0;
      font-size: 0.8rem;
    }

    .chart-container {
      position: relative;
      height: 300px;
      margin: 16px 0;
    }

    .chart-legend {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 6px 16px;
      padding: 10px;
      background: #FAFBFC;
      border-radius: 4px;
      margin-top: 8px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 0.7rem;
      color: var(--gray);
      cursor: pointer;
      padding: 3px 6px;
      border-radius: 3px;
      transition: background 0.2s;
    }

    .legend-item:hover { background: #E4E6E9; }
    .legend-item.disabled { opacity: 0.4; text-decoration: line-through; }

    .legend-color {
      width: 14px;
      height: 3px;
      border-radius: 1px;
    }

    .legend-color.dashed {
      background: repeating-linear-gradient(90deg, currentColor, currentColor 3px, transparent 3px, transparent 6px);
      height: 2px;
    }

    /* What-If Panel */
    .whatif-panel {
      background: var(--light-gray);
      border-radius: 6px;
      padding: 14px;
      margin-top: 16px;
    }

    .whatif-panel h4 {
      margin: 0 0 12px 0;
      font-size: 0.9rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .whatif-panel h4 button {
      background: none;
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
      color: var(--gray);
    }

    .scenario-type-tabs {
      display: flex;
      gap: 4px;
      margin-bottom: 12px;
    }

    .scenario-type-tabs button {
      flex: 1;
      padding: 8px;
      border: none;
      border-radius: 4px;
      font-size: 0.75rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .scenario-type-tabs button.active {
      background: var(--blue);
      color: white;
      font-weight: 600;
    }

    .scenario-type-tabs button:not(.active) {
      background: white;
      color: var(--gray);
    }

    .scenario-controls {
      margin-bottom: 12px;
    }

    .scenario-toggle-row {
      display: flex;
      gap: 8px;
      margin-bottom: 8px;
    }

    .scenario-toggle-row button {
      flex: 1;
      padding: 6px;
      border: 2px solid var(--border);
      border-radius: 4px;
      font-size: 0.75rem;
      cursor: pointer;
      transition: all 0.2s;
      background: white;
    }

    .scenario-toggle-row button.active.add {
      border-color: var(--green);
      background: #E3FCEF;
      color: var(--green);
    }

    .scenario-toggle-row button.active.remove {
      border-color: var(--red);
      background: #FFEBE6;
      color: var(--red);
    }

    .scenario-input-row {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .scenario-input-row input[type="number"],
    .scenario-input-row input[type="date"] {
      width: 60px;
      padding: 6px;
      text-align: center;
      border: 2px solid var(--border);
      border-radius: 4px;
      font-size: 0.75rem;
    }

    .scenario-input-row input[type="range"] {
      flex: 1;
      min-width: 100px;
    }

    .scenario-input-row span {
      font-size: 0.75rem;
      color: var(--gray);
    }

    .scenario-preview {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid var(--border);
    }

    .scenario-preview .preview-text {
      flex: 1;
      font-size: 0.8rem;
    }

    .scenario-preview .add-btn {
      padding: 8px 16px;
      background: var(--blue);
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 600;
      cursor: pointer;
    }

    .active-scenarios {
      background: white;
      border-radius: 4px;
      padding: 10px;
      margin-bottom: 12px;
    }

    .active-scenarios-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      font-size: 0.7rem;
      font-weight: 600;
      color: var(--gray);
    }

    .active-scenarios-header button {
      font-size: 0.65rem;
      color: var(--red);
      background: none;
      border: none;
      cursor: pointer;
    }

    .scenario-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px 8px;
      background: var(--light-gray);
      border-radius: 4px;
      margin-bottom: 4px;
      font-size: 0.75rem;
    }

    .scenario-item.disabled {
      opacity: 0.5;
    }

    .scenario-item .desc {
      flex: 1;
    }

    .scenario-item .remove-btn {
      background: none;
      border: none;
      color: var(--gray);
      cursor: pointer;
      font-size: 1rem;
    }

    .combined-effect {
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid var(--border);
      font-size: 0.75rem;
    }

    .combined-effect .row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 4px;
    }

    /* Scope Tab */
    .scope-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 10px;
      margin-bottom: 20px;
    }

    .scope-stat {
      text-align: center;
      padding: 12px;
      background: var(--light-gray);
      border-radius: 6px;
    }

    .scope-stat .value {
      font-size: 1.25rem;
      font-weight: 700;
    }

    .scope-stat .value.positive { color: var(--red); }
    .scope-stat .value.negative { color: var(--green); }

    .scope-stat .label {
      font-size: 0.65rem;
      color: var(--gray);
      text-transform: uppercase;
    }

    .alert-item {
      padding: 10px 12px;
      background: #FFFAE6;
      border-left: 4px solid var(--yellow);
      border-radius: 0 4px 4px 0;
      margin-bottom: 8px;
      font-size: 0.8rem;
    }

    /* Team Tab */
    .team-grid {
      display: grid;
      gap: 12px;
    }

    .team-member {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px;
      background: var(--light-gray);
      border-radius: 8px;
    }

    .member-avatar {
      width: 44px;
      height: 44px;
      background: var(--green);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 1rem;
    }

    .member-info {
      flex: 1;
    }

    .member-name {
      font-weight: 600;
      margin-bottom: 4px;
    }

    .member-stats {
      display: flex;
      gap: 12px;
      font-size: 0.75rem;
      color: var(--gray);
    }

    .load-bar {
      height: 6px;
      background: var(--border);
      border-radius: 3px;
      margin-top: 8px;
      overflow: hidden;
    }

    .load-fill {
      height: 100%;
      border-radius: 3px;
      transition: width 0.5s ease;
    }

    .load-fill.good { background: var(--green); }
    .load-fill.warning { background: var(--yellow); }
    .load-fill.danger { background: var(--red); }

    .member-status {
      padding: 4px 10px;
      border-radius: 10px;
      font-size: 0.65rem;
      font-weight: 600;
      text-transform: uppercase;
    }

    .member-status.on_track { background: #E3FCEF; color: var(--green); }
    .member-status.overloaded { background: #FFEBE6; color: var(--red); }
    .member-status.under_utilized { background: #FFFAE6; color: var(--yellow); }
    .member-status.no_capacity { background: var(--border); color: var(--gray); }

    /* Capacity Tab */
    .capacity-config {
      max-width: 600px;
    }

    .capacity-row {
      margin-bottom: 16px;
    }

    .capacity-row label {
      display: block;
      font-size: 0.8rem;
      font-weight: 500;
      margin-bottom: 6px;
    }

    .capacity-toggle {
      display: flex;
      gap: 4px;
    }

    .capacity-toggle button {
      flex: 1;
      padding: 8px 12px;
      border: 2px solid var(--border);
      border-radius: 4px;
      background: white;
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .capacity-toggle button.active {
      border-color: var(--green);
      background: #E3FCEF;
      color: var(--green);
      font-weight: 600;
    }

    .capacity-members-list {
      margin-top: 16px;
    }

    .capacity-member-header {
      display: grid;
      grid-template-columns: 1fr 100px 40px;
      gap: 12px;
      padding: 8px 0;
      border-bottom: 1px solid var(--border);
      font-size: 0.7rem;
      font-weight: 600;
      color: var(--gray);
      text-transform: uppercase;
    }

    .capacity-member-row {
      display: grid;
      grid-template-columns: 1fr 100px 40px;
      gap: 12px;
      padding: 10px 0;
      border-bottom: 1px solid var(--light-gray);
      align-items: center;
    }

    .capacity-member-row input {
      width: 100%;
      padding: 6px;
      border: 1px solid var(--border);
      border-radius: 4px;
      font-size: 0.85rem;
      text-align: center;
    }

    .capacity-member-row .remove-btn {
      background: none;
      border: none;
      color: var(--red);
      cursor: pointer;
      font-size: 1.2rem;
    }

    .capacity-total {
      margin-top: 16px;
      padding: 12px;
      background: var(--light-gray);
      border-radius: 6px;
      font-size: 0.9rem;
    }

    .capacity-total strong {
      color: var(--green);
    }

    .save-btn {
      margin-top: 16px;
      padding: 10px 20px;
      background: var(--green);
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
    }

    .save-btn:hover {
      background: #006644;
    }

    /* Compliance Tab */
    .compliance-summary {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-bottom: 20px;
    }

    .stat-card {
      background: var(--light-gray);
      padding: 16px;
      border-radius: 6px;
      text-align: center;
    }

    .stat-card .value {
      font-size: 2rem;
      font-weight: 700;
    }

    .stat-card .value.danger { color: var(--red); }
    .stat-card .value.warning { color: var(--yellow); }
    .stat-card .value.info { color: var(--blue); }

    .stat-card .label {
      font-size: 0.7rem;
      color: var(--gray);
      text-transform: uppercase;
    }

    .violation-filters {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
      flex-wrap: wrap;
    }

    .violation-filters button {
      padding: 6px 12px;
      border: 1px solid var(--border);
      border-radius: 16px;
      background: white;
      font-size: 0.75rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .violation-filters button.active {
      background: var(--blue);
      color: white;
      border-color: var(--blue);
    }

    .violation-item {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 12px;
      background: var(--light-gray);
      border-radius: 6px;
      margin-bottom: 8px;
      border-left: 4px solid var(--border);
    }

    .violation-item.error { border-left-color: var(--red); background: #FFEBE6; }
    .violation-item.warning { border-left-color: var(--yellow); background: #FFFAE6; }
    .violation-item.info { border-left-color: var(--blue); background: #DEEBFF; }

    .violation-icon { font-size: 1.1rem; }

    .violation-content { flex: 1; }

    .violation-key {
      font-weight: 600;
      color: var(--blue);
      font-size: 0.85rem;
    }

    .violation-summary {
      font-size: 0.85rem;
    }

    .violation-message {
      color: var(--gray);
      font-size: 0.75rem;
      margin-top: 3px;
    }

    /* Dependencies Tab */
    .dep-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 12px;
      margin-bottom: 20px;
    }

    .cycle-warning {
      background: #FFEBE6;
      border: 1px solid var(--red);
      border-radius: 6px;
      padding: 14px;
      margin-bottom: 16px;
    }

    .cycle-warning h4 {
      color: var(--red);
      margin: 0 0 8px 0;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .cycle-path {
      font-family: 'Fira Code', monospace;
      background: white;
      padding: 8px 12px;
      border-radius: 4px;
      font-size: 0.8rem;
    }

    .dep-list {
      max-height: 350px;
      overflow-y: auto;
      border: 1px solid var(--border);
      border-radius: 6px;
    }

    .dep-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      border-bottom: 1px solid var(--light-gray);
    }

    .dep-item:last-child { border-bottom: none; }

    .dep-depth {
      width: 24px;
      height: 24px;
      background: var(--green);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      font-weight: 600;
      flex-shrink: 0;
    }

    .dep-key {
      font-weight: 600;
      color: var(--blue);
      font-size: 0.85rem;
      min-width: 80px;
    }

    .dep-summary {
      color: var(--gray);
      font-size: 0.8rem;
      flex: 1;
    }

    .dep-blockers {
      font-size: 0.7rem;
      color: var(--gray);
    }

    /* Report Tab */
    .report-section {
      margin-bottom: 24px;
    }

    .report-section h3 {
      font-size: 1rem;
      margin: 0 0 12px 0;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--border);
    }

    .report-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
    }

    .report-metric {
      padding: 14px;
      background: var(--light-gray);
      border-radius: 6px;
    }

    .report-metric .value {
      font-size: 1.5rem;
      font-weight: 700;
    }

    .report-metric .value.green { color: var(--green); }
    .report-metric .value.yellow { color: var(--yellow); }
    .report-metric .value.red { color: var(--red); }

    .report-metric .label {
      font-size: 0.75rem;
      color: var(--gray);
    }

    .decision-card {
      padding: 14px;
      border-radius: 6px;
      margin-bottom: 10px;
      border-left: 4px solid var(--border);
    }

    .decision-card.high {
      background: #FFEBE6;
      border-left-color: var(--red);
    }

    .decision-card.medium {
      background: #FFFAE6;
      border-left-color: var(--yellow);
    }

    .decision-title {
      font-weight: 600;
      margin-bottom: 4px;
      font-size: 0.9rem;
    }

    .decision-description {
      font-size: 0.8rem;
      color: var(--gray);
    }

    /* Demo Info */
    .demo-info {
      margin-top: 24px;
      padding: 20px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .demo-info h3 {
      margin: 0 0 12px 0;
    }

    .demo-info ul {
      margin: 0 0 16px 0;
      padding-left: 20px;
      color: var(--gray);
    }

    .demo-info li {
      margin-bottom: 4px;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .demo-container { padding: 10px; }
      .tab-button { padding: 10px 8px; font-size: 0.7rem; }
      .summary-bar { gap: 12px; }
      .chart-container { height: 250px; }
    }
  </style>
</head>
<body>
  <div class="demo-header">
    <h1>
      <span>üìä</span> Beyond Burndown
      <span class="demo-badge">INTERACTIVE DEMO</span>
    </h1>
    <a href="index.html" style="color: white; text-decoration: none; font-size: 0.8rem;">‚Üê Back to Home</a>
  </div>

  <div class="demo-container">
    <div class="gadget-container">
      <!-- Summary Bar -->
      <div class="summary-bar">
        <div class="summary-item">
          <span class="summary-value" id="issues-count">18</span>
          <span class="summary-label">Issues</span>
        </div>
        <div class="summary-item">
          <span class="summary-value warning" id="feasibility-display">73%</span>
          <span class="summary-label">Feasibility</span>
        </div>
        <div class="summary-item">
          <span class="summary-value danger">9</span>
          <span class="summary-label">Violations</span>
        </div>
        <div class="summary-item">
          <span class="summary-value danger">1</span>
          <span class="summary-label">Cycles</span>
        </div>
        <div class="summary-item">
          <div class="confidence-indicator">
            <div class="confidence-bar">
              <div class="confidence-fill medium" style="width: 78%"></div>
            </div>
            <span style="font-size: 0.7rem; color: var(--gray);">78%</span>
          </div>
          <span class="summary-label">Confidence</span>
        </div>

        <!-- Export Menu -->
        <div class="export-menu-container">
          <button class="export-btn" onclick="toggleExportMenu()">
            üìã Export ‚ñæ
          </button>
          <div class="export-dropdown" id="export-dropdown">
            <button onclick="copyAsText()">üìÑ Copy as Text</button>
            <button onclick="copyAsMarkdown()">üìù Copy as Markdown</button>
            <button onclick="downloadCSV()">üìä Download CSV</button>
          </div>
        </div>
      </div>

      <!-- Forecast Warning -->
      <div class="forecast-warning warning">
        <span>‚ö†Ô∏è</span>
        <span id="forecast-message">Work completes Feb 18 (2 days after deadline)</span>
      </div>

      <!-- Tab Navigation -->
      <div class="tab-navigation">
        <button class="tab-button active" data-tab="feasibility">Feasibility</button>
        <button class="tab-button" data-tab="scope">Scope <span class="badge warning">2</span></button>
        <button class="tab-button" data-tab="team">Team <span class="badge danger">!</span></button>
        <button class="tab-button" data-tab="capacity">Capacity</button>
        <button class="tab-button" data-tab="compliance">Compliance <span class="badge">9</span></button>
        <button class="tab-button" data-tab="dependencies">Dependencies <span class="badge danger">1</span></button>
        <button class="tab-button" data-tab="report">Report</button>
      </div>

      <!-- Tab Content -->
      <div class="tab-content">
        <!-- FEASIBILITY TAB -->
        <div class="tab-panel active" id="tab-feasibility">
          <div class="feasibility-header">
            <div class="score-display-inline">
              <span class="score" id="feasibility-score" style="color: var(--yellow)">73%</span>
              <span class="label">Feasibility Score</span>
            </div>
            <div class="controls-row">
              <div style="font-size: 0.75rem; color: var(--gray);">
                <span id="totals-display">613h demand / 608h capacity / 32.5h spent</span>
              </div>
              <div class="target-date-control">
                <input type="checkbox" id="target-date-check">
                <label for="target-date-check">Target</label>
                <input type="date" id="target-date" style="display: none;">
              </div>
              <select class="period-select" id="period-select">
                <option value="daily">Daily</option>
                <option value="weekly">Weekly</option>
                <option value="biweekly">Bi-weekly</option>
                <option value="monthly">Monthly</option>
              </select>
              <button class="whatif-toggle" id="whatif-toggle">Show What-If</button>
            </div>
          </div>

          <!-- Overload Warning -->
          <div class="overload-warning" id="overload-warning">
            <strong>‚ö†Ô∏è Overloaded:</strong> Feb 1 to Feb 8 (6 days, max 42h over capacity)
          </div>

          <!-- Chart -->
          <div class="chart-container">
            <canvas id="feasibilityChart"></canvas>
          </div>

          <!-- Interactive Legend -->
          <div class="chart-legend" id="chart-legend">
            <!-- Populated by JS -->
          </div>
          <div style="text-align: center; font-size: 0.65rem; color: #97A0AF; margin-top: 4px;">
            Click legend items to show/hide
          </div>

          <!-- Scenario Indicator -->
          <div id="scenario-indicator" style="display: none; margin-top: 12px; padding: 10px 14px; background: #DEEBFF; border-radius: 6px; font-size: 0.8rem; color: var(--blue);">
            <span id="scenario-text"></span>
            <button onclick="clearAllScenarios()" style="float: right; background: var(--red); color: white; border: none; border-radius: 4px; padding: 4px 10px; font-size: 0.7rem; cursor: pointer;">Clear All</button>
          </div>

          <!-- What-If Panel -->
          <div class="whatif-panel" id="whatif-panel" style="display: none;">
            <h4>
              What-If Scenarios
              <button onclick="toggleWhatIf()">√ó</button>
            </h4>

            <!-- Active Scenarios -->
            <div class="active-scenarios" id="active-scenarios" style="display: none;">
              <div class="active-scenarios-header">
                <span>Active Scenarios</span>
                <button onclick="clearAllScenarios()">Clear All</button>
              </div>
              <div id="scenario-list"></div>
              <div class="combined-effect" id="combined-effect"></div>
            </div>

            <!-- Add New Scenario -->
            <div style="font-size: 0.75rem; font-weight: 600; color: var(--gray); margin-bottom: 10px;">Add Scenario</div>

            <div class="scenario-type-tabs">
              <button class="active" data-type="capacity" onclick="setScenarioType('capacity')">Capacity</button>
              <button data-type="scope" onclick="setScenarioType('scope')">Scope</button>
              <button data-type="deadline" onclick="setScenarioType('deadline')">Deadline</button>
            </div>

            <!-- Capacity Controls -->
            <div class="scenario-controls" id="capacity-controls">
              <div class="scenario-toggle-row">
                <button class="active add" onclick="setCapacityMode('add')">Add Capacity</button>
                <button onclick="setCapacityMode('remove')">Remove Capacity</button>
              </div>
              <div class="scenario-input-row">
                <input type="number" id="dev-count" value="1" min="1" max="10">
                <span>dev(s) @</span>
                <input type="number" id="hours-per-dev" value="8" min="1" max="12">
                <span>h/day</span>
              </div>
            </div>

            <!-- Scope Controls -->
            <div class="scenario-controls" id="scope-controls" style="display: none;">
              <div class="scenario-toggle-row">
                <button class="active add" onclick="setScopeMode('remove')">Remove Scope</button>
                <button onclick="setScopeMode('add')">Add Scope</button>
              </div>
              <div class="scenario-input-row">
                <input type="range" id="scope-slider" min="0" max="300" value="60">
                <input type="number" id="scope-hours" value="60" min="0">
                <span>hours</span>
              </div>
            </div>

            <!-- Deadline Controls -->
            <div class="scenario-controls" id="deadline-controls" style="display: none;">
              <div class="scenario-input-row">
                <span>New deadline:</span>
                <input type="date" id="new-deadline" style="width: 140px;">
              </div>
              <div id="deadline-info" style="font-size: 0.7rem; color: var(--gray); margin-top: 6px;"></div>
            </div>

            <!-- Preview -->
            <div class="scenario-preview">
              <div class="preview-text" id="scenario-preview">
                <span style="font-weight: 600; color: var(--green);">+1 dev @ 8h/day</span>
                ‚Üí <span style="color: var(--green);">86% feasibility</span>
              </div>
              <button class="add-btn" onclick="addScenario()">Add</button>
            </div>
          </div>
        </div>

        <!-- SCOPE TAB -->
        <div class="tab-panel" id="tab-scope">
          <div class="scope-stats">
            <div class="scope-stat">
              <div class="value">120h</div>
              <div class="label">Original</div>
            </div>
            <div class="scope-stat">
              <div class="value">215h</div>
              <div class="label">Current</div>
            </div>
            <div class="scope-stat">
              <div class="value positive">+140h</div>
              <div class="label">Added</div>
            </div>
            <div class="scope-stat">
              <div class="value negative">-45h</div>
              <div class="label">Removed</div>
            </div>
            <div class="scope-stat">
              <div class="value positive">+79%</div>
              <div class="label">Net Change</div>
            </div>
          </div>

          <div class="chart-container">
            <canvas id="scopeChart"></canvas>
          </div>

          <h4 style="margin-top: 20px;">Scope Alerts</h4>
          <div class="alert-item">
            <strong>‚ö†Ô∏è Scope Creep:</strong> Scope increased 79% since project start (120h ‚Üí 215h)
          </div>
          <div class="alert-item">
            <strong>‚ÑπÔ∏è Recent:</strong> 65 hours added in the last 5 days
          </div>
        </div>

        <!-- TEAM TAB -->
        <div class="tab-panel" id="tab-team">
          <div class="team-grid" id="team-list"></div>
        </div>

        <!-- CAPACITY TAB -->
        <div class="tab-panel" id="tab-capacity">
          <div class="capacity-config">
            <div class="capacity-row">
              <label>Capacity Type</label>
              <div class="capacity-toggle">
                <button onclick="setCapacityType('team')">Team Total</button>
                <button class="active" onclick="setCapacityType('individual')">Per User</button>
              </div>
            </div>

            <div class="capacity-row">
              <label>Time Period</label>
              <div class="capacity-toggle">
                <button class="active" onclick="setCapacityPeriod('week')">Weekly</button>
                <button onclick="setCapacityPeriod('month')">Monthly</button>
              </div>
            </div>

            <div class="capacity-row">
              <label>Schedule</label>
              <div class="capacity-toggle">
                <button class="active" onclick="setCapacitySchedule('fixed')">Fixed</button>
                <button onclick="setCapacitySchedule('variable')">Variable</button>
              </div>
            </div>

            <div class="capacity-members-list">
              <div class="capacity-member-header">
                <span>Team Member</span>
                <span>Hours/Week</span>
                <span></span>
              </div>
              <div id="capacity-members"></div>
            </div>

            <div class="capacity-total">
              <strong>Total: <span id="capacity-total">152</span> hrs/week</strong>
            </div>

            <button class="save-btn" onclick="saveCapacity()">üíæ Save Capacity</button>
          </div>
        </div>

        <!-- COMPLIANCE TAB -->
        <div class="tab-panel" id="tab-compliance">
          <div class="compliance-summary">
            <div class="stat-card">
              <div class="value danger">4</div>
              <div class="label">Errors</div>
            </div>
            <div class="stat-card">
              <div class="value warning">4</div>
              <div class="label">Warnings</div>
            </div>
            <div class="stat-card">
              <div class="value info">1</div>
              <div class="label">Info</div>
            </div>
          </div>

          <div class="violation-filters">
            <button class="active" data-filter="all" onclick="filterViolations('all')">All (9)</button>
            <button data-filter="error" onclick="filterViolations('error')">Errors (4)</button>
            <button data-filter="warning" onclick="filterViolations('warning')">Warnings (4)</button>
            <button data-filter="info" onclick="filterViolations('info')">Info (1)</button>
          </div>

          <div id="violations-list"></div>
        </div>

        <!-- DEPENDENCIES TAB -->
        <div class="tab-panel" id="tab-dependencies">
          <div class="dep-stats">
            <div class="stat-card">
              <div class="value">15</div>
              <div class="label">Total Issues</div>
            </div>
            <div class="stat-card">
              <div class="value">5</div>
              <div class="label">Max Depth</div>
            </div>
            <div class="stat-card">
              <div class="value danger">1</div>
              <div class="label">Cycles</div>
            </div>
            <div class="stat-card">
              <div class="value">4</div>
              <div class="label">Leaf Issues</div>
            </div>
          </div>

          <div class="cycle-warning">
            <h4>‚ö†Ô∏è Circular Dependency Detected</h4>
            <div class="cycle-path">DEMO-120 ‚Üí DEMO-121 ‚Üí DEMO-122 ‚Üí DEMO-120</div>
            <p style="margin: 8px 0 0; font-size: 0.8rem; color: var(--gray);">
              This cycle must be broken before these issues can be completed.
            </p>
          </div>

          <h4>Dependency Chain (by depth)</h4>
          <div class="dep-list" id="dep-list"></div>
        </div>

        <!-- REPORT TAB -->
        <div class="tab-panel" id="tab-report">
          <div class="report-section">
            <h3>üìä Executive Summary</h3>
            <div class="report-grid">
              <div class="report-metric">
                <div class="value yellow">73%</div>
                <div class="label">Feasibility</div>
              </div>
              <div class="report-metric">
                <div class="value red">101%</div>
                <div class="label">Utilization</div>
              </div>
              <div class="report-metric">
                <div class="value">5%</div>
                <div class="label">Completion</div>
              </div>
              <div class="report-metric">
                <div class="value red">2 days</div>
                <div class="label">Behind</div>
              </div>
            </div>
          </div>

          <div class="report-section">
            <h3>üìà Capacity vs Demand</h3>
            <div class="report-grid">
              <div class="report-metric">
                <div class="value green">608h</div>
                <div class="label">Capacity</div>
              </div>
              <div class="report-metric">
                <div class="value red">613h</div>
                <div class="label">Demand</div>
              </div>
              <div class="report-metric">
                <div class="value">32.5h</div>
                <div class="label">Spent</div>
              </div>
              <div class="report-metric">
                <div class="value red">-5h</div>
                <div class="label">Gap</div>
              </div>
            </div>
          </div>

          <div class="report-section">
            <h3>üéØ Decisions Needed</h3>
            <div class="decision-card high">
              <div class="decision-title">Capacity Gap</div>
              <div class="decision-description">
                Demand exceeds capacity by 5 hours. Options: Add overtime, reduce scope, or extend deadline.
              </div>
            </div>
            <div class="decision-card high">
              <div class="decision-title">Circular Dependencies</div>
              <div class="decision-description">
                1 circular dependency chain blocking work. Break cycle: DEMO-120 ‚Üí 121 ‚Üí 122.
              </div>
            </div>
            <div class="decision-card medium">
              <div class="decision-title">Overdue Issues</div>
              <div class="decision-description">
                2 issues are overdue (48h of work). Review blockers and reassign.
              </div>
            </div>
            <div class="decision-card medium">
              <div class="decision-title">Scope Creep</div>
              <div class="decision-description">
                Scope increased 79% since start. Review additions and prioritize.
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Demo Info -->
    <div class="demo-info">
      <h3>About This Demo</h3>
      <p style="color: var(--gray); margin-bottom: 12px;">
        This fully interactive demo shows Beyond Burndown with realistic sample data:
      </p>
      <ul>
        <li><strong>Feasibility:</strong> Interactive chart with period aggregation, target date, What-If scenarios</li>
        <li><strong>What-If:</strong> Add/remove capacity, change scope, extend deadlines - see instant impact</li>
        <li><strong>Scope:</strong> Track scope creep with visual timeline and alerts</li>
        <li><strong>Team:</strong> Workload distribution per team member with status indicators</li>
        <li><strong>Capacity:</strong> Configure team/individual capacity, weekly/monthly periods</li>
        <li><strong>Compliance:</strong> Filter violations by severity, see detailed issue info</li>
        <li><strong>Dependencies:</strong> Circular dependency detection, depth analysis</li>
        <li><strong>Report:</strong> Executive summary with key metrics and decisions</li>
      </ul>
      <div style="margin-top: 16px;">
        <a href="https://marketplace.atlassian.com/" class="btn btn-primary" style="text-decoration: none;">
          Install on Your Jira
        </a>
        <a href="user-manual.html" class="btn btn-secondary" style="text-decoration: none; margin-left: 10px;">
          User Manual
        </a>
      </div>
    </div>
  </div>

  <script src="demo-data.js"></script>
  <script>
    // ========== STATE ==========
    let state = {
      activeTab: 'feasibility',
      period: 'daily',
      showTargetDate: false,
      targetDate: null,
      showWhatIf: false,
      scenarios: [],
      scenarioType: 'capacity',
      capacityMode: 'add',
      scopeMode: 'remove',
      visibleLines: {
        periodCapacity: true,
        periodDemand: true,
        capacity: true,
        demand: true,
        timeSpent: true
      },
      violationFilter: 'all',
      // Base values
      baseFeasibility: 73,
      baseCapacity: 608,
      baseDemand: 613,
      totalDays: 20
    };

    let feasibilityChart = null;
    let scopeChart = null;

    // ========== DEMO DATA ==========
    const teamMembers = [
      { name: 'Alice Chen', capacity: 160, demand: 145, timeSpent: 12, issues: 5, load: 91, status: 'on_track' },
      { name: 'Bob Martinez', capacity: 160, demand: 180, timeSpent: 8, issues: 6, load: 113, status: 'overloaded' },
      { name: 'Carol Kim', capacity: 160, demand: 120, timeSpent: 10, issues: 4, load: 75, status: 'under_utilized' },
      { name: 'David Patel', capacity: 128, demand: 168, timeSpent: 2.5, issues: 3, load: 131, status: 'overloaded' },
      { name: 'Unassigned', capacity: 0, demand: 65, timeSpent: 0, issues: 5, load: null, status: 'no_capacity' }
    ];

    const capacityMembers = [
      { name: 'Alice Chen', hours: 40 },
      { name: 'Bob Martinez', hours: 40 },
      { name: 'Carol Kim', hours: 40 },
      { name: 'David Patel', hours: 32 }
    ];

    const violations = [
      { type: 'overdue', severity: 'error', key: 'DEMO-103', summary: 'API optimization', message: 'Overdue by 3 days' },
      { type: 'dependency', severity: 'error', key: 'DEMO-104', summary: 'Database migration', message: 'Blocked by DEMO-106 (finishes 2 days after start)' },
      { type: 'child_parent', severity: 'error', key: 'DEMO-111', summary: 'Mobile app feature', message: 'Due 5 days after parent DEMO-100' },
      { type: 'overdue', severity: 'error', key: 'DEMO-107', summary: 'Search functionality', message: 'Overdue by 1 day' },
      { type: 'missing_dates', severity: 'warning', key: 'DEMO-108', summary: 'Payment gateway', message: 'Missing start and due date' },
      { type: 'missing_dates', severity: 'warning', key: 'DEMO-112', summary: 'Email notifications', message: 'Missing due date' },
      { type: 'missing_estimate', severity: 'warning', key: 'DEMO-109', summary: 'Analytics widgets', message: 'Missing time estimate' },
      { type: 'missing_estimate', severity: 'warning', key: 'DEMO-116', summary: 'Dark mode', message: 'Missing time estimate' },
      { type: 'missing_dates', severity: 'info', key: 'DEMO-115', summary: 'Profile customization', message: 'Missing start date' }
    ];

    const dependencies = [
      { key: 'DEMO-100', summary: 'Epic: Q1 Release', depth: 0, blockers: [] },
      { key: 'DEMO-101', summary: 'User authentication', depth: 1, blockers: ['DEMO-100'] },
      { key: 'DEMO-102', summary: 'Dashboard redesign', depth: 1, blockers: ['DEMO-100'] },
      { key: 'DEMO-103', summary: 'API optimization', depth: 1, blockers: ['DEMO-100'] },
      { key: 'DEMO-104', summary: 'Database migration', depth: 2, blockers: ['DEMO-101'] },
      { key: 'DEMO-105', summary: 'Testing framework', depth: 2, blockers: ['DEMO-101'] },
      { key: 'DEMO-106', summary: 'Chart components', depth: 2, blockers: ['DEMO-102'] },
      { key: 'DEMO-107', summary: 'Search functionality', depth: 2, blockers: ['DEMO-103'] },
      { key: 'DEMO-108', summary: 'Payment gateway', depth: 3, blockers: ['DEMO-104'] },
      { key: 'DEMO-109', summary: 'Analytics widgets', depth: 3, blockers: ['DEMO-106'] },
      { key: 'DEMO-110', summary: 'Checkout flow', depth: 4, blockers: ['DEMO-108'] },
      { key: 'DEMO-111', summary: 'Mobile feature', depth: 5, blockers: ['DEMO-110'] }
    ];

    // ========== INITIALIZATION ==========
    document.addEventListener('DOMContentLoaded', () => {
      initTabs();
      initCharts();
      initLegend();
      renderTeam();
      renderCapacity();
      renderViolations();
      renderDependencies();
      initTargetDate();
      initWhatIfControls();
      updateScenarioPreview();
    });

    // ========== TABS ==========
    function initTabs() {
      document.querySelectorAll('.tab-button').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
          document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
          btn.classList.add('active');
          document.getElementById('tab-' + btn.dataset.tab).classList.add('active');
          state.activeTab = btn.dataset.tab;
        });
      });
    }

    // ========== CHARTS ==========
    function initCharts() {
      initFeasibilityChart();
      initScopeChart();
    }

    function initFeasibilityChart() {
      const ctx = document.getElementById('feasibilityChart').getContext('2d');
      const data = window.DEMO_DATA.envelope.timeline;

      feasibilityChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.map(d => d.displayDate),
          datasets: [
            {
              label: 'Daily Capacity',
              data: data.map(d => d.capacity),
              borderColor: '#00875A',
              backgroundColor: 'rgba(0,135,90,0.1)',
              fill: false,
              tension: 0.3,
              borderWidth: 2,
              pointRadius: 0
            },
            {
              label: 'Daily Demand',
              data: data.map(d => d.demand),
              borderColor: '#0052CC',
              backgroundColor: 'rgba(0,82,204,0.1)',
              fill: false,
              tension: 0.3,
              borderWidth: 2,
              pointRadius: 0
            },
            {
              label: 'Cumulative Capacity',
              data: data.map(d => d.cumulativeCapacity),
              borderColor: '#00875A',
              borderDash: [5, 5],
              fill: false,
              tension: 0.3,
              borderWidth: 2,
              pointRadius: 0
            },
            {
              label: 'Cumulative Demand',
              data: data.map(d => d.cumulativeDemand),
              borderColor: '#0052CC',
              borderDash: [5, 5],
              fill: false,
              tension: 0.3,
              borderWidth: 2,
              pointRadius: 0
            },
            {
              label: 'Time Spent',
              data: data.map(d => d.cumulativeTimeSpent),
              borderColor: '#FF8B00',
              borderDash: [5, 5],
              fill: false,
              tension: 0.3,
              borderWidth: 2,
              pointRadius: 0
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: { intersect: false, mode: 'index' },
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                afterBody: (items) => {
                  const idx = items[0].dataIndex;
                  const d = data[idx];
                  if (d.isOverloaded) {
                    return `\n‚ö†Ô∏è Overloaded by ${d.overload}h`;
                  }
                  return '';
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              title: { display: true, text: 'Hours' }
            }
          }
        }
      });
    }

    function initScopeChart() {
      const ctx = document.getElementById('scopeChart').getContext('2d');
      const scopeData = [
        { date: 'Jan 18', added: 120, removed: 0 },
        { date: 'Jan 22', added: 45, removed: 0 },
        { date: 'Jan 25', added: 0, removed: 20 },
        { date: 'Jan 27', added: 30, removed: 0 },
        { date: 'Jan 29', added: 25, removed: 15 },
        { date: 'Jan 31', added: 40, removed: 0 },
        { date: 'Feb 1', added: 0, removed: 10 }
      ];

      scopeChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: scopeData.map(d => d.date),
          datasets: [
            {
              label: 'Added',
              data: scopeData.map(d => d.added),
              backgroundColor: '#DE350B'
            },
            {
              label: 'Removed',
              data: scopeData.map(d => -d.removed),
              backgroundColor: '#00875A'
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { position: 'bottom' } },
          scales: {
            x: { stacked: true },
            y: { stacked: true, title: { display: true, text: 'Hours' } }
          }
        }
      });
    }

    // ========== LEGEND ==========
    function initLegend() {
      const legendItems = [
        { key: 'periodCapacity', label: 'Daily Capacity', color: '#00875A', dashed: false },
        { key: 'periodDemand', label: 'Daily Demand', color: '#0052CC', dashed: false },
        { key: 'capacity', label: 'Cumulative Capacity', color: '#00875A', dashed: true },
        { key: 'demand', label: 'Cumulative Demand', color: '#0052CC', dashed: true },
        { key: 'timeSpent', label: 'Time Spent', color: '#FF8B00', dashed: true }
      ];

      const container = document.getElementById('chart-legend');
      container.innerHTML = legendItems.map(item => `
        <div class="legend-item ${state.visibleLines[item.key] ? '' : 'disabled'}" data-key="${item.key}">
          <div class="legend-color ${item.dashed ? 'dashed' : ''}" style="background: ${item.color}; color: ${item.color};"></div>
          <span>${item.label}</span>
        </div>
      `).join('');

      container.querySelectorAll('.legend-item').forEach(el => {
        el.addEventListener('click', () => {
          const key = el.dataset.key;
          state.visibleLines[key] = !state.visibleLines[key];
          el.classList.toggle('disabled');
          updateChartVisibility();
        });
      });
    }

    function updateChartVisibility() {
      const mapping = {
        periodCapacity: 0,
        periodDemand: 1,
        capacity: 2,
        demand: 3,
        timeSpent: 4
      };
      Object.entries(mapping).forEach(([key, idx]) => {
        feasibilityChart.data.datasets[idx].hidden = !state.visibleLines[key];
      });
      feasibilityChart.update();
    }

    // ========== TEAM ==========
    function renderTeam() {
      const container = document.getElementById('team-list');
      container.innerHTML = teamMembers.map(m => {
        const initials = m.name.split(' ').map(n => n[0]).join('').substring(0, 2);
        const loadWidth = Math.min(m.load || 0, 150);
        const loadClass = m.load > 100 ? 'danger' : m.load > 80 ? 'warning' : 'good';
        const statusLabels = {
          on_track: 'On Track', overloaded: 'Overloaded',
          under_utilized: 'Under-utilized', no_capacity: 'No Capacity'
        };
        return `
          <div class="team-member">
            <div class="member-avatar">${initials}</div>
            <div class="member-info">
              <div class="member-name">${m.name}</div>
              <div class="member-stats">
                <span>${m.issues} issues</span>
                <span>${m.demand}h demand</span>
                <span>${m.capacity}h capacity</span>
              </div>
              <div class="load-bar">
                <div class="load-fill ${loadClass}" style="width: ${loadWidth}%"></div>
              </div>
            </div>
            <div class="member-status ${m.status}">${statusLabels[m.status]}</div>
          </div>
        `;
      }).join('');
    }

    // ========== CAPACITY ==========
    function renderCapacity() {
      const container = document.getElementById('capacity-members');
      container.innerHTML = capacityMembers.map((m, i) => `
        <div class="capacity-member-row">
          <span>${m.name}</span>
          <input type="number" value="${m.hours}" min="0" max="80" onchange="updateCapacityHours(${i}, this.value)">
          <button class="remove-btn" onclick="removeCapacityMember(${i})">√ó</button>
        </div>
      `).join('');
      updateCapacityTotal();
    }

    function updateCapacityHours(idx, value) {
      capacityMembers[idx].hours = parseInt(value) || 0;
      updateCapacityTotal();
    }

    function removeCapacityMember(idx) {
      capacityMembers.splice(idx, 1);
      renderCapacity();
    }

    function updateCapacityTotal() {
      const total = capacityMembers.reduce((sum, m) => sum + m.hours, 0);
      document.getElementById('capacity-total').textContent = total;
    }

    function setCapacityType(type) {
      document.querySelectorAll('#tab-capacity .capacity-row:first-child button').forEach(b => b.classList.remove('active'));
      event.target.classList.add('active');
    }

    function setCapacityPeriod(period) {
      document.querySelectorAll('#tab-capacity .capacity-row:nth-child(2) button').forEach(b => b.classList.remove('active'));
      event.target.classList.add('active');
    }

    function setCapacitySchedule(schedule) {
      document.querySelectorAll('#tab-capacity .capacity-row:nth-child(3) button').forEach(b => b.classList.remove('active'));
      event.target.classList.add('active');
    }

    function saveCapacity() {
      alert('Capacity saved! (Demo mode - changes are not persisted)');
    }

    // ========== VIOLATIONS ==========
    function renderViolations() {
      const filtered = state.violationFilter === 'all'
        ? violations
        : violations.filter(v => v.severity === state.violationFilter);

      const icons = { error: '‚ùå', warning: '‚ö†Ô∏è', info: '‚ÑπÔ∏è' };
      const container = document.getElementById('violations-list');
      container.innerHTML = filtered.map(v => `
        <div class="violation-item ${v.severity}">
          <div class="violation-icon">${icons[v.severity]}</div>
          <div class="violation-content">
            <span class="violation-key">${v.key}</span>
            <span class="violation-summary"> - ${v.summary}</span>
            <div class="violation-message">${v.message}</div>
          </div>
        </div>
      `).join('');
    }

    function filterViolations(filter) {
      state.violationFilter = filter;
      document.querySelectorAll('.violation-filters button').forEach(b => {
        b.classList.toggle('active', b.dataset.filter === filter);
      });
      renderViolations();
    }

    // ========== DEPENDENCIES ==========
    function renderDependencies() {
      const container = document.getElementById('dep-list');
      container.innerHTML = dependencies.map(d => `
        <div class="dep-item">
          <div class="dep-depth">${d.depth}</div>
          <span class="dep-key">${d.key}</span>
          <span class="dep-summary">${d.summary}</span>
          <span class="dep-blockers">${d.blockers.length > 0 ? '‚Üê ' + d.blockers.join(', ') : ''}</span>
        </div>
      `).join('');
    }

    // ========== TARGET DATE ==========
    function initTargetDate() {
      const checkbox = document.getElementById('target-date-check');
      const input = document.getElementById('target-date');

      checkbox.addEventListener('change', () => {
        state.showTargetDate = checkbox.checked;
        input.style.display = checkbox.checked ? 'inline-block' : 'none';
      });
    }

    // ========== WHAT-IF ==========
    function toggleWhatIf() {
      state.showWhatIf = !state.showWhatIf;
      document.getElementById('whatif-panel').style.display = state.showWhatIf ? 'block' : 'none';
      document.getElementById('whatif-toggle').classList.toggle('active', state.showWhatIf);
      document.getElementById('whatif-toggle').textContent = state.showWhatIf ? 'Hide What-If' : 'Show What-If';
    }

    function initWhatIfControls() {
      // Set up deadline date
      const today = new Date();
      today.setDate(today.getDate() + 22);
      document.getElementById('new-deadline').value = today.toISOString().split('T')[0];

      // Scope slider
      document.getElementById('scope-slider').addEventListener('input', (e) => {
        document.getElementById('scope-hours').value = e.target.value;
        updateScenarioPreview();
      });
      document.getElementById('scope-hours').addEventListener('input', (e) => {
        document.getElementById('scope-slider').value = e.target.value;
        updateScenarioPreview();
      });

      // Other inputs
      ['dev-count', 'hours-per-dev', 'new-deadline'].forEach(id => {
        document.getElementById(id).addEventListener('input', updateScenarioPreview);
      });
    }

    function setScenarioType(type) {
      state.scenarioType = type;
      document.querySelectorAll('.scenario-type-tabs button').forEach(b => {
        b.classList.toggle('active', b.dataset.type === type);
      });
      document.getElementById('capacity-controls').style.display = type === 'capacity' ? 'block' : 'none';
      document.getElementById('scope-controls').style.display = type === 'scope' ? 'block' : 'none';
      document.getElementById('deadline-controls').style.display = type === 'deadline' ? 'block' : 'none';
      updateScenarioPreview();
    }

    function setCapacityMode(mode) {
      state.capacityMode = mode;
      const btns = document.querySelectorAll('#capacity-controls .scenario-toggle-row button');
      btns[0].className = mode === 'add' ? 'active add' : '';
      btns[1].className = mode === 'remove' ? 'active remove' : '';
      updateScenarioPreview();
    }

    function setScopeMode(mode) {
      state.scopeMode = mode;
      const btns = document.querySelectorAll('#scope-controls .scenario-toggle-row button');
      btns[0].className = mode === 'remove' ? 'active add' : '';
      btns[1].className = mode === 'add' ? 'active remove' : '';
      updateScenarioPreview();
    }

    function updateScenarioPreview() {
      const preview = document.getElementById('scenario-preview');
      let description, newFeasibility, color;

      if (state.scenarioType === 'capacity') {
        const devs = parseInt(document.getElementById('dev-count').value) || 1;
        const hours = parseInt(document.getElementById('hours-per-dev').value) || 8;
        const change = devs * hours * state.totalDays * (state.capacityMode === 'add' ? 1 : -1);
        const newCap = state.baseCapacity + change + getTotalCapacityChange();
        const newDem = state.baseDemand + getTotalDemandChange();
        newFeasibility = Math.round(Math.min(100, (newCap / newDem) * 100));
        description = `${state.capacityMode === 'add' ? '+' : '-'}${devs} dev${devs > 1 ? 's' : ''} @ ${hours}h/day`;
        color = state.capacityMode === 'add' ? 'var(--green)' : 'var(--red)';
      } else if (state.scenarioType === 'scope') {
        const hours = parseInt(document.getElementById('scope-hours').value) || 0;
        const change = hours * (state.scopeMode === 'remove' ? -1 : 1);
        const newCap = state.baseCapacity + getTotalCapacityChange();
        const newDem = Math.max(0, state.baseDemand + change + getTotalDemandChange());
        newFeasibility = Math.round(Math.min(100, (newCap / newDem) * 100));
        description = `${change >= 0 ? '+' : ''}${change}h scope`;
        color = change < 0 ? 'var(--green)' : 'var(--red)';
      } else {
        const newDate = document.getElementById('new-deadline').value;
        const currentEnd = new Date();
        currentEnd.setDate(currentEnd.getDate() + 15);
        const daysDiff = Math.round((new Date(newDate) - currentEnd) / (1000 * 60 * 60 * 24));
        const businessDays = Math.round(daysDiff * 5 / 7);
        const avgDaily = state.baseCapacity / state.totalDays;
        const change = avgDaily * businessDays;
        const newCap = state.baseCapacity + change + getTotalCapacityChange();
        const newDem = state.baseDemand + getTotalDemandChange();
        newFeasibility = Math.round(Math.min(100, (newCap / newDem) * 100));
        description = `Deadline ${daysDiff >= 0 ? '+' : ''}${daysDiff} days`;
        color = daysDiff > 0 ? 'var(--green)' : 'var(--red)';
        document.getElementById('deadline-info').textContent =
          `Current: Feb 16 ‚Üí New: ${new Date(newDate).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} (${daysDiff} days)`;
      }

      const feasColor = newFeasibility >= 80 ? 'var(--green)' : newFeasibility >= 50 ? 'var(--yellow)' : 'var(--red)';
      preview.innerHTML = `
        <span style="font-weight: 600; color: ${color};">${description}</span>
        ‚Üí <span style="color: ${feasColor};">${newFeasibility}% feasibility</span>
      `;
    }

    function getTotalCapacityChange() {
      return state.scenarios.filter(s => s.enabled).reduce((sum, s) => sum + (s.capacityChange || 0), 0);
    }

    function getTotalDemandChange() {
      return state.scenarios.filter(s => s.enabled).reduce((sum, s) => sum + (s.demandChange || 0), 0);
    }

    function addScenario() {
      let scenario = { id: Date.now(), enabled: true, capacityChange: 0, demandChange: 0 };

      if (state.scenarioType === 'capacity') {
        const devs = parseInt(document.getElementById('dev-count').value) || 1;
        const hours = parseInt(document.getElementById('hours-per-dev').value) || 8;
        const change = devs * hours * state.totalDays * (state.capacityMode === 'add' ? 1 : -1);
        scenario.description = `${state.capacityMode === 'add' ? '+' : '-'}${devs} dev @ ${hours}h/day`;
        scenario.capacityChange = change;
        scenario.color = state.capacityMode === 'add' ? 'var(--green)' : 'var(--red)';
      } else if (state.scenarioType === 'scope') {
        const hours = parseInt(document.getElementById('scope-hours').value) || 0;
        const change = hours * (state.scopeMode === 'remove' ? -1 : 1);
        scenario.description = `${change >= 0 ? '+' : ''}${change}h scope`;
        scenario.demandChange = change;
        scenario.color = change < 0 ? 'var(--green)' : 'var(--red)';
      } else {
        const newDate = document.getElementById('new-deadline').value;
        const currentEnd = new Date();
        currentEnd.setDate(currentEnd.getDate() + 15);
        const daysDiff = Math.round((new Date(newDate) - currentEnd) / (1000 * 60 * 60 * 24));
        const businessDays = Math.round(daysDiff * 5 / 7);
        const avgDaily = state.baseCapacity / state.totalDays;
        scenario.description = `Deadline ${daysDiff >= 0 ? '+' : ''}${daysDiff} days`;
        scenario.capacityChange = avgDaily * businessDays;
        scenario.color = daysDiff > 0 ? 'var(--green)' : 'var(--red)';
      }

      state.scenarios.push(scenario);
      renderScenarios();
      updateFeasibilityDisplay();
    }

    function renderScenarios() {
      const container = document.getElementById('active-scenarios');
      const list = document.getElementById('scenario-list');
      const combined = document.getElementById('combined-effect');

      if (state.scenarios.length === 0) {
        container.style.display = 'none';
        document.getElementById('scenario-indicator').style.display = 'none';
        return;
      }

      container.style.display = 'block';
      list.innerHTML = state.scenarios.map(s => `
        <div class="scenario-item ${s.enabled ? '' : 'disabled'}">
          <input type="checkbox" ${s.enabled ? 'checked' : ''} onchange="toggleScenario(${s.id})">
          <span class="desc" style="color: ${s.color};">${s.description}</span>
          <button class="remove-btn" onclick="removeScenario(${s.id})">√ó</button>
        </div>
      `).join('');

      // Combined effect
      const enabled = state.scenarios.filter(s => s.enabled);
      const totalCap = getTotalCapacityChange();
      const totalDem = getTotalDemandChange();
      const newCap = state.baseCapacity + totalCap;
      const newDem = Math.max(0, state.baseDemand + totalDem);
      const newFeas = Math.round(Math.min(100, (newCap / newDem) * 100));
      const feasColor = newFeas >= 80 ? 'var(--green)' : newFeas >= 50 ? 'var(--yellow)' : 'var(--red)';

      combined.innerHTML = `
        <div class="row">
          <span style="color: var(--gray);">Combined Feasibility:</span>
          <span style="font-weight: 600; color: ${feasColor};">${state.baseFeasibility}% ‚Üí ${newFeas}%</span>
        </div>
        ${totalCap !== 0 ? `<div class="row"><span style="color: #97A0AF;">Capacity:</span><span style="color: ${totalCap > 0 ? 'var(--green)' : 'var(--red)'};">${totalCap > 0 ? '+' : ''}${Math.round(totalCap)}h</span></div>` : ''}
        ${totalDem !== 0 ? `<div class="row"><span style="color: #97A0AF;">Demand:</span><span style="color: ${totalDem < 0 ? 'var(--green)' : 'var(--red)'};">${totalDem > 0 ? '+' : ''}${Math.round(totalDem)}h</span></div>` : ''}
      `;

      // Scenario indicator
      const indicator = document.getElementById('scenario-indicator');
      indicator.style.display = 'block';
      document.getElementById('scenario-text').textContent =
        `Viewing ${enabled.length} scenario(s) ‚Ä¢ ${newFeas}% feasibility`;
    }

    function toggleScenario(id) {
      const s = state.scenarios.find(s => s.id === id);
      if (s) s.enabled = !s.enabled;
      renderScenarios();
      updateFeasibilityDisplay();
    }

    function removeScenario(id) {
      state.scenarios = state.scenarios.filter(s => s.id !== id);
      renderScenarios();
      updateFeasibilityDisplay();
    }

    function clearAllScenarios() {
      state.scenarios = [];
      renderScenarios();
      updateFeasibilityDisplay();
    }

    function updateFeasibilityDisplay() {
      const totalCap = getTotalCapacityChange();
      const totalDem = getTotalDemandChange();
      const newCap = state.baseCapacity + totalCap;
      const newDem = Math.max(0, state.baseDemand + totalDem);
      const newFeas = state.scenarios.filter(s => s.enabled).length > 0
        ? Math.round(Math.min(100, (newCap / newDem) * 100))
        : state.baseFeasibility;

      const color = newFeas >= 80 ? 'var(--green)' : newFeas >= 50 ? 'var(--yellow)' : 'var(--red)';
      document.getElementById('feasibility-score').style.color = color;
      document.getElementById('feasibility-score').textContent = newFeas + '%';
      document.getElementById('feasibility-display').textContent = newFeas + '%';
      document.getElementById('feasibility-display').className = 'summary-value ' +
        (newFeas >= 80 ? 'success' : newFeas >= 50 ? 'warning' : 'danger');
    }

    // ========== EXPORT ==========
    function toggleExportMenu() {
      document.getElementById('export-dropdown').classList.toggle('open');
    }

    function copyAsText() {
      const text = `Beyond Burndown Report
====================
Feasibility: 73%
Issues: 18
Violations: 9
Circular Dependencies: 1

Capacity: 608h
Demand: 613h
Gap: -5h

Status: At Risk (2 days behind schedule)`;
      navigator.clipboard.writeText(text);
      alert('Copied to clipboard!');
      toggleExportMenu();
    }

    function copyAsMarkdown() {
      const md = `# Beyond Burndown Report

## Summary
- **Feasibility:** 73%
- **Issues:** 18
- **Violations:** 9
- **Circular Dependencies:** 1

## Capacity
| Metric | Value |
|--------|-------|
| Capacity | 608h |
| Demand | 613h |
| Gap | -5h |

## Status
‚ö†Ô∏è At Risk (2 days behind schedule)`;
      navigator.clipboard.writeText(md);
      alert('Copied to clipboard!');
      toggleExportMenu();
    }

    function downloadCSV() {
      const csv = `Date,Capacity,Demand,Overloaded
Jan 27,32,28,No
Jan 28,32,30,No
Jan 29,32,35,No
Jan 30,32,32,No
Jan 31,32,38,Yes
Feb 1,32,40,Yes`;
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'beyond-burndown-export.csv';
      a.click();
      toggleExportMenu();
    }

    // Close export menu when clicking outside
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.export-menu-container')) {
        document.getElementById('export-dropdown').classList.remove('open');
      }
    });
  </script>
</body>
</html>
